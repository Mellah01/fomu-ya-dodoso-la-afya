<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dodoso la Afya ya Mgonjwa (PHQ-9)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white rounded-xl shadow-2xl p-8 max-w-2xl w-full">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Dodoso la Afya</h1>
        <p class="text-center italic text-sm text-gray-600 mb-6">
            Fomu hii ni kwa ajili ya tathmini ya kiwango cha sonona. Jaza kwa uaminifu kila swali ili kukupa majibu halisi.
        </p>

        <p class="text-lg text-gray-700 mb-4">
            Katika wiki mbili zilizopita, ni mara ngapi umesumbuliwa na shida zifuatazo?
        </p>
        <div class="grid grid-cols-4 gap-4 text-center text-sm font-semibold text-gray-600 mb-6">
            <div>Hakuna Kabisa = 0</div>
            <div>Siku kadhaa = 1</div>
            <div>Zaidi ya siku kadhaa = 2</div>
            <div>Karibia kila siku = 3</div>
        </div>

        <form id="phq-form">
            <div id="questions-container"></div>
            
            <div class="mt-6">
                <p class="text-base text-gray-600">Ni kwa jinsi gani matatizo haya yamekufanya ushindwe kufanya kazi zako, kushughulika na vitu vya nyumbani, au kuwa na mahusiano mazuri na watu wengine?</p>
                <div class="mt-2 flex flex-wrap gap-4">
                    <label class="inline-flex items-center">
                        <input type="radio" name="difficulty" value="Sio ngumu kabisa" class="form-radio text-indigo-600">
                        <span class="ml-2 text-gray-700">Sio ngumu kabisa</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="difficulty" value="Ngumu kiasi" class="form-radio text-indigo-600">
                        <span class="ml-2 text-gray-700">Ngumu kiasi</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="difficulty" value="Ngumu sana" class="form-radio text-indigo-600">
                        <span class="ml-2 text-gray-700">Ngumu sana</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="difficulty" value="Ngumu mno" class="form-radio text-indigo-600">
                        <span class="ml-2 text-gray-700">Ngumu mno</span>
                    </label>
                </div>
            </div>

            <div class="flex justify-center mt-8">
                <button type="submit" id="submit-button" class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-full hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300 shadow-md">
                    Tuma Majibu Yangu
                </button>
            </div>
        </form>

        <div id="result-container" class="mt-8 hidden">
            <div class="bg-indigo-100 border-l-4 border-indigo-500 text-indigo-700 p-4 rounded-lg shadow-md" role="alert">
                <p class="font-bold text-xl mb-2">Matokeo Yako:</p>
                <div class="flex items-center justify-between">
                    <p class="text-lg">Jumla ya Alama:</p>
                    <p id="score" class="font-bold text-2xl"></p>
                </div>
                <div class="mt-4">
                    <p class="text-lg">Tafsiri ya kiwango cha sonona:</p>
                    <p id="interpretation" class="font-semibold text-lg"></p>
                </div>
            </div>

            <p class="font-bold text-center text-gray-700 mt-6">
                Kutokana na maelezo ya dodoso hili na tahmini, kama umegundua unapitia changamoto yeyote, wasiliana na mtaalam wa afya ya akili katika idara ya afya na magonjwa ya akili kwa msaada zaidi.
            </p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const questions = [
                'Kuwa na shauku kidogo au kutokuwa na hamu ya kufanya vitu?',
                'Kujisikia mnyonge, kuwa na sonona au kukata tamaa?',
                'Shida kupata usingizi, kulala au kulala sana?',
                'Kuchoka au kuwa na nguvu kidogo?',
                'Kukosa hamu ya kula au kula sana?',
                'Kujisikia hatia wewe binafsi, au umejiangusha mwenyewe pamoja na familia yako?',
                'Unapata shida ya kukosa umakini kwenye vitu kama kusoma magazeti au kuangalia luninga?',
                'Kutembea au kuzungumza taratibu sana kiasi watu wengine wamegundua? Au kinyume chake â€“ yaani kutokuwa na utulivu au kuzunguka sana kuliko kawaida?',
                'Mawazo ya kuwa bora ufe au kujiumiza kwa namna yeyote ile?'
            ];

            const questionsContainer = document.getElementById('questions-container');
            const form = document.getElementById('phq-form');
            const resultContainer = document.getElementById('result-container');
            const scoreElement = document.getElementById('score');
            const interpretationElement = document.getElementById('interpretation');

            const createQuestion = (index, questionText) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'flex items-start mb-6';
                questionDiv.innerHTML = `
                    <p class="w-10 flex-shrink-0 text-xl font-bold text-gray-600">${index + 1}.</p>
                    <div class="flex-grow">
                        <p class="text-md font-medium text-gray-800">${questionText}</p>
                        <div class="flex flex-row space-x-2 mt-2">
                            <label class="inline-flex items-center cursor-pointer p-2 rounded-full hover:bg-indigo-50 transition duration-300">
                                <input type="radio" name="q${index}" value="0" class="form-radio text-indigo-600">
                                <span class="ml-2 text-gray-700">0</span>
                            </label>
                            <label class="inline-flex items-center cursor-pointer p-2 rounded-full hover:bg-indigo-50 transition duration-300">
                                <input type="radio" name="q${index}" value="1" class="form-radio text-indigo-600">
                                <span class="ml-2 text-gray-700">1</span>
                            </label>
                            <label class="inline-flex items-center cursor-pointer p-2 rounded-full hover:bg-indigo-50 transition duration-300">
                                <input type="radio" name="q${index}" value="2" class="form-radio text-indigo-600">
                                <span class="ml-2 text-gray-700">2</span>
                            </label>
                            <label class="inline-flex items-center cursor-pointer p-2 rounded-full hover:bg-indigo-50 transition duration-300">
                                <input type="radio" name="q${index}" value="3" class="form-radio text-indigo-600">
                                <span class="ml-2 text-gray-700">3</span>
                            </label>
                        </div>
                    </div>
                `;
                return questionDiv;
            };

            questions.forEach((q, index) => {
                questionsContainer.appendChild(createQuestion(index, q));
            });

            form.addEventListener('submit', (e) => {
                e.preventDefault(); 
                
                let totalScore = 0;
                let allQuestionsAnswered = true;
                const formData = {
                    answers: {},
                    score: 0,
                    interpretation: '',
                    difficulty: ''
                };

                for (let i = 0; i < questions.length; i++) {
                    const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                    if (selectedOption) {
                        const score = parseInt(selectedOption.value, 10);
                        totalScore += score;
                        formData.answers[`question_${i+1}`] = {
                            question: questions[i],
                            score: score
                        };
                    } else {
                        allQuestionsAnswered = false;
                        const message = document.createElement('div');
                        message.textContent = 'Tafadhali jibu maswali yote kabla ya kutuma.';
                        message.className = 'absolute top-5 left-1/2 -translate-x-1/2 bg-red-500 text-white p-4 rounded shadow-lg transition-opacity duration-300';
                        document.body.appendChild(message);
                        setTimeout(() => message.remove(), 3000);
                        return;
                    }
                }
                
                const difficultyRadio = document.querySelector('input[name="difficulty"]:checked');
                if (difficultyRadio) {
                    formData.difficulty = difficultyRadio.value;
                }

                formData.score = totalScore;
                
                let interpretationText = '';
                if (totalScore >= 0 && totalScore <= 4) {
                    interpretationText = 'Hakuna/ndogo sana (Endelea kuchukua hatua za kujikinga)';
                } else if (totalScore >= 5 && totalScore <= 9) {
                    interpretationText = 'Kiwango cha chini (Ongea na rafiki/familia, jumuika na Jamie)';
                } else if (totalScore >= 10 && totalScore <= 14) {
                    interpretationText = 'Wastani (Zungumza na mshauri/mtaalamu mapema)';
                } else if (totalScore >= 15 && totalScore <= 19) {
                    interpretationText = 'Kali (Muone daktari au mtaalamu wa afya ya akili)';
                } else if (totalScore >= 20 && totalScore <= 27) {
                    interpretationText = 'Kali sana (Tafuta msaada wa haraka wa kitabibu)';
                }
                formData.interpretation = interpretationText;
                scoreElement.textContent = totalScore;
                interpretationElement.textContent = interpretationText;
                resultContainer.classList.remove('hidden');

                console.log('Majibu na matokeo yaliyoandaliwa kwa seva:', formData);
                
                const message = document.createElement('div');
                message.textContent = 'Asante, majibu yako yamekamilika na yameandaliwa!';
                message.className = 'absolute top-5 left-1/2 -translate-x-1/2 bg-green-500 text-white p-4 rounded shadow-lg transition-opacity duration-300';
                document.body.appendChild(message);
                setTimeout(() => message.remove(), 3000);
            });
        });
    </script>
</body>
</html>